# 从 Vue 的生命周期钩子函数看钩子函数


## **Vue 的生命周期钩子函数**
Vue 组件从创建到销毁的整个生命周期中，会在特定阶段触发一些函数，这些函数被称为**生命周期钩子（Lifecycle Hooks）**。开发者可以在这些钩子中插入自己的代码，以便在组件的不同阶段执行特定逻辑。

---

### **1. Vue 2.x 的生命周期钩子**
| **钩子函数**            | **触发时机**                                                                 | **典型用途**                                  |
|-------------------------|-----------------------------------------------------------------------------|---------------------------------------------|
| `beforeCreate`          | 实例初始化后，数据观测（data observer）和事件配置之前。                      | 初始化非响应式变量（如插件配置）。             |
| `created`               | 实例创建完成，数据观测已配置，但 DOM 未生成。                                | 异步请求数据、初始化计算属性。                 |
| `beforeMount`           | 模板编译完成，但尚未挂载到 DOM。                                            | 很少使用，可用于最后的渲染前修改。             |
| `mounted`               | 实例挂载到 DOM 后触发（仅首次渲染）。                                        | 操作 DOM、初始化第三方库（如图表库）。         |
| `beforeUpdate`          | 数据变化导致虚拟 DOM 重新渲染之前。                                          | 更新前获取 DOM 状态（如滚动位置）。            |
| `updated`               | 虚拟 DOM 重新渲染并应用到 DOM 后。                                          | 数据更新后操作 DOM（注意避免无限循环）。       |
| `beforeDestroy`         | 实例销毁前触发（仍可访问数据和方法）。                                       | 清除定时器、解绑全局事件。                     |
| `destroyed`             | 实例销毁后触发（所有绑定和监听被移除）。                                     | 清理内存、取消未完成的异步任务。               |

---

### **2. Vue 3.x 的生命周期钩子（Composition API）**
Vue 3 保留了 Vue 2 的选项式 API 钩子，同时在 Composition API 中提供了对应的函数形式：
| **选项式 API**       | **Composition API（`setup()` 内使用）**      |
|----------------------|---------------------------------------------|
| `beforeCreate`       | 无直接对应，`setup()` 在 `beforeCreate` 前执行。 |
| `created`            | 无直接对应，`setup()` 在 `created` 前执行。    |
| `beforeMount`        | `onBeforeMount`                             |
| `mounted`            | `onMounted`                                 |
| `beforeUpdate`       | `onBeforeUpdate`                            |
| `updated`            | `onUpdated`                                 |
| `beforeUnmount`     | `onBeforeUnmount`（Vue 3 中替代 `beforeDestroy`） |
| `unmounted`         | `onUnmounted`（Vue 3 中替代 `destroyed`）     |

**示例（Vue 3 Composition API）**：
```javascript
import { onMounted, onUnmounted } from 'vue';

export default {
  setup() {
    onMounted(() => {
      console.log('组件已挂载');
    });
    onUnmounted(() => {
      console.log('组件已销毁');
    });
  }
};
```

---

## **什么是“钩子函数”？**
**钩子函数（Hook）** 是一种编程概念，指在**特定事件或阶段发生时自动触发的回调函数**。它的核心思想是：
- **“挂入”**（Hook into）系统的执行流程，在预定义的位置插入自定义逻辑。
- **不修改原有代码**，通过扩展机制增强功能。

### **为什么叫“钩子”（Hook）？**
- **来源**：该术语源自操作系统和底层开发，指**拦截或监听事件/消息的机制**（如 Windows 的消息钩子）。
- **类比**：钩子就像钓鱼的鱼钩，你可以将自定义逻辑“挂”在框架的执行流程上，等待框架在合适的时机“钓起”（触发）你的代码。
- **在 Vue 中的含义**：  
  Vue 的生命周期是一个固定的流程（如创建 → 挂载 → 更新 → 销毁），钩子函数允许开发者“钩住”这些关键节点，插入自己的代码，就像在流程中挂上一个钩子。

---

### **钩子函数的通用特点**
| **特点**          | **说明**                                                                 |
|-------------------|-------------------------------------------------------------------------|
| **被动触发**       | 由框架/系统自动调用，而非开发者显式调用。                                |
| **标准化时机**     | 钩子的触发时机由框架严格定义（如 `mounted` 只在 DOM 挂载后触发）。        |
| **可扩展性**       | 允许在不修改框架源码的情况下增强功能。                                    |

---

## **其他技术中的钩子函数**
- **React**：`useEffect`、`useState` 等 Hooks。  
- **Git**：`pre-commit`、`post-receive` 等钩子脚本。  
- **Webpack**：`beforeCompile`、`afterEmit` 等插件钩子。  

---

## **总结**
1. **Vue 生命周期钩子**是组件从生到死的各个关键节点触发的函数，用于控制代码执行时机。  
2. **钩子函数（Hook）**的本质是“挂入”系统流程的扩展点，实现非侵入式编程。  
3. **“钩子”**一词形象表达了**在固定流程中挂载自定义逻辑**的机制。  

**使用场景建议**：  
- `created` / `onMounted`：初始化数据或 DOM 操作。  
- `beforeDestroy` / `onUnmounted`：清理资源，避免内存泄漏。  
- `beforeUpdate`：跟踪状态变化。